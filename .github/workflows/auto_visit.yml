name: Google IDX Auto Visit (24h保活)

on:
  schedule:
    - cron: "*/10 * * * *" # 初始为固定10分钟
  workflow_dispatch:

jobs:
  visit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Install dependencies
        run: npm install puppeteer

      - name: Random wait before start
        run: |
          WAIT=$(( (RANDOM % 10) + 1 ))
          echo "⏳ 随机等待 ${WAIT} 分钟后开始访问..."
          sleep $((WAIT * 60))

      - name: Run auto visit
        run: node auto_visit.cjs
